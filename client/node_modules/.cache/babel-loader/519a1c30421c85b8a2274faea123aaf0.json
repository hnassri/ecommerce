{"ast":null,"code":"var _jsxFileName = \"/home/epitech/Documents/e-commerce/client/src/context/auth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/React.createContext();\n\nfunction getUser() {\n  const token = localStorage.getItem(\"token\");\n  return token ? jwt_decode(token) : null;\n}\n\nconst token = localStorage.getItem(\"token\");\n\nconst AuthProvider = props => {\n  _s();\n\n  const [user, setUser] = useState(getUser());\n  useEffect(() => {//setUser(useUser());    \n    // Pull saved login state from localStorage / AsyncStorage\n  }, []);\n\n  const login = (email, password) => {\n    let formData = new FormData();\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n    const header = {\n      \"Content-Type\": \"multipart/form-data\"\n    };\n    axios.post(\"http://206.81.25.252:8000/login\", formData, header).then(res => {\n      if (res.data.success) {\n        const data = res.data;\n        localStorage.setItem(\"token\", data.token);\n      }\n\n      setUser(getUser());\n    }).catch(e => {\n      console.log(e.response.data.message);\n    });\n  };\n\n  const register = (email, password) => {\n    let formData = new FormData();\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n    const header = {\n      \"Content-Type\": \"multipart/form-data\"\n    };\n    axios.post(\"http://206.81.25.252:8000/api/v1/register\", formData, header).then(res => {\n      window.location.href = \"/login\";\n    }).catch(e => {\n      console.log(e.response.data.error);\n    });\n  };\n\n  const logout = () => {\n    setUser(null);\n  };\n\n  const authContextValue = {\n    login,\n    user,\n    logout,\n    register\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: authContextValue,\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 12\n  }, this);\n};\n\n_s(AuthProvider, \"Hy5qQOiZ5KhXDYqRkvABzHPxen0=\");\n\n_c = AuthProvider;\n\nconst useAuth = () => {\n  _s2();\n\n  return React.useContext(AuthContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport { AuthProvider, useAuth };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/home/epitech/Documents/e-commerce/client/src/context/auth.js"],"names":["React","useState","useEffect","jwt_decode","axios","Redirect","AuthContext","createContext","getUser","token","localStorage","getItem","AuthProvider","props","user","setUser","login","email","password","formData","FormData","append","header","post","then","res","data","success","setItem","catch","e","console","log","response","message","register","window","location","href","error","logout","authContextValue","useAuth","useContext"],"mappings":"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","sourcesContent":["import React, { useState, useEffect} from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router-dom\";\n\nconst AuthContext = React.createContext();\nfunction getUser() {\n    const token = localStorage.getItem(\"token\");\n    return token ? jwt_decode(token) : null;\n}\nconst token = localStorage.getItem(\"token\");\n\nconst AuthProvider = (props) => {\n    const [user, setUser] = useState(getUser());\n    useEffect(() => {\n        //setUser(useUser());    \n        \n        // Pull saved login state from localStorage / AsyncStorage\n      }, []);\n\n    const login = (email, password) => {\n        let formData = new FormData();\n        formData.append(\"email\", email);\n        formData.append(\"password\", password);\n        const header = {\n            \"Content-Type\": \"multipart/form-data\"\n        }\n        axios.post(\"http://206.81.25.252:8000/login\", formData, header)\n            .then(res => {\n                if(res.data.success){\n                    const data = res.data;\n                    localStorage.setItem(\"token\", data.token);\n                }\n                setUser(getUser());\n            })\n            .catch(e => {\n                console.log(e.response.data.message);\n            })\n       \n    }\n\n    const register = (email, password) => {\n        let formData = new FormData();\n        formData.append(\"email\", email);\n        formData.append(\"password\", password);\n        const header = {\n            \"Content-Type\": \"multipart/form-data\"\n        }\n        axios.post(\"http://206.81.25.252:8000/api/v1/register\", formData, header)\n            .then(res => {\n                window.location.href = \"/login\";\n            })\n            .catch(e => {\n                console.log(e.response.data.error);\n            })\n       \n    }\n  \n    const logout = () => {\n        setUser(null);\n    };\n  \n    const authContextValue = {\n      login,\n      user,\n      logout,\n      register,\n      \n    };\n  \n    return <AuthContext.Provider value={authContextValue} {...props} />;\n  };\n  \n  const useAuth = () => React.useContext(AuthContext);\n  \n  export { AuthProvider, useAuth };"]},"metadata":{},"sourceType":"module"}