{"ast":null,"code":"'use strict';\n\nfunction _events() {\n  const data = require('events');\n\n  _events = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction path() {\n  const data = _interopRequireWildcard(require('path'));\n\n  path = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _anymatch() {\n  const data = _interopRequireDefault(require('anymatch'));\n\n  _anymatch = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction fs() {\n  const data = _interopRequireWildcard(require('graceful-fs'));\n\n  fs = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _micromatch() {\n  const data = _interopRequireDefault(require('micromatch'));\n\n  _micromatch = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _walker() {\n  const data = _interopRequireDefault(require('walker'));\n\n  _walker = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== 'function') return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== 'object' && typeof obj !== 'function') {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n} // eslint-disable-next-line @typescript-eslint/prefer-ts-expect-error\n// @ts-ignore: this is for CI which runs linux and might not have this\n\n\nlet fsevents = null;\n\ntry {\n  fsevents = require('fsevents');\n} catch {// Optional dependency, only supported on Darwin.\n}\n\nconst CHANGE_EVENT = 'change';\nconst DELETE_EVENT = 'delete';\nconst ADD_EVENT = 'add';\nconst ALL_EVENT = 'all';\n/**\n * Export `FSEventsWatcher` class.\n * Watches `dir`.\n */\n\nclass FSEventsWatcher extends _events().EventEmitter {\n  static isSupported() {\n    return fsevents !== null;\n  }\n\n  static normalizeProxy(callback) {\n    return (filepath, stats) => callback(path().normalize(filepath), stats);\n  }\n\n  static recReaddir(dir, dirCallback, fileCallback, endCallback, errorCallback, ignored) {\n    (0, _walker().default)(dir).filterDir(currentDir => !ignored || !(0, _anymatch().default)(ignored, currentDir)).on('dir', FSEventsWatcher.normalizeProxy(dirCallback)).on('file', FSEventsWatcher.normalizeProxy(fileCallback)).on('error', errorCallback).on('end', () => {\n      endCallback();\n    });\n  }\n\n  constructor(dir, opts) {\n    if (!fsevents) {\n      throw new Error('`fsevents` unavailable (this watcher can only be used on Darwin)');\n    }\n\n    super();\n\n    _defineProperty(this, 'root', void 0);\n\n    _defineProperty(this, 'ignored', void 0);\n\n    _defineProperty(this, 'glob', void 0);\n\n    _defineProperty(this, 'dot', void 0);\n\n    _defineProperty(this, 'hasIgnore', void 0);\n\n    _defineProperty(this, 'doIgnore', void 0);\n\n    _defineProperty(this, 'fsEventsWatchStopper', void 0);\n\n    _defineProperty(this, '_tracked', void 0);\n\n    this.dot = opts.dot || false;\n    this.ignored = opts.ignored;\n    this.glob = Array.isArray(opts.glob) ? opts.glob : [opts.glob];\n    this.hasIgnore = Boolean(opts.ignored) && !(Array.isArray(opts) && opts.length > 0);\n    this.doIgnore = opts.ignored ? (0, _anymatch().default)(opts.ignored) : () => false;\n    this.root = path().resolve(dir);\n    this.fsEventsWatchStopper = fsevents.watch(this.root, this.handleEvent.bind(this));\n    this._tracked = new Set();\n    FSEventsWatcher.recReaddir(this.root, filepath => {\n      this._tracked.add(filepath);\n    }, filepath => {\n      this._tracked.add(filepath);\n    }, this.emit.bind(this, 'ready'), this.emit.bind(this, 'error'), this.ignored);\n  }\n  /**\n   * End watching.\n   */\n\n\n  close(callback) {\n    this.fsEventsWatchStopper().then(() => {\n      this.removeAllListeners();\n\n      if (typeof callback === 'function') {\n        process.nextTick(callback.bind(null, null, true));\n      }\n    });\n  }\n\n  isFileIncluded(relativePath) {\n    if (this.doIgnore(relativePath)) {\n      return false;\n    }\n\n    return this.glob.length ? (0, _micromatch().default)([relativePath], this.glob, {\n      dot: this.dot\n    }).length > 0 : this.dot || (0, _micromatch().default)([relativePath], '**/*').length > 0;\n  }\n\n  handleEvent(filepath) {\n    const relativePath = path().relative(this.root, filepath);\n\n    if (!this.isFileIncluded(relativePath)) {\n      return;\n    }\n\n    fs().lstat(filepath, (error, stat) => {\n      if (error && error.code !== 'ENOENT') {\n        this.emit('error', error);\n        return;\n      }\n\n      if (error) {\n        // Ignore files that aren't tracked and don't exist.\n        if (!this._tracked.has(filepath)) {\n          return;\n        }\n\n        this._emit(DELETE_EVENT, relativePath);\n\n        this._tracked.delete(filepath);\n\n        return;\n      }\n\n      if (this._tracked.has(filepath)) {\n        this._emit(CHANGE_EVENT, relativePath, stat);\n      } else {\n        this._tracked.add(filepath);\n\n        this._emit(ADD_EVENT, relativePath, stat);\n      }\n    });\n  }\n  /**\n   * Emit events.\n   */\n\n\n  _emit(type, file, stat) {\n    this.emit(type, file, this.root, stat);\n    this.emit(ALL_EVENT, type, file, this.root, stat);\n  }\n\n}\n\nmodule.exports = FSEventsWatcher;","map":{"version":3,"sources":["/home/epitech/Documents/e-commerce/client/node_modules/jest-haste-map/build/lib/FSEventsWatcher.js"],"names":["_events","data","require","path","_interopRequireWildcard","_anymatch","_interopRequireDefault","fs","_micromatch","_walker","obj","__esModule","default","_getRequireWildcardCache","WeakMap","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_defineProperty","value","enumerable","configurable","writable","fsevents","CHANGE_EVENT","DELETE_EVENT","ADD_EVENT","ALL_EVENT","FSEventsWatcher","EventEmitter","isSupported","normalizeProxy","callback","filepath","stats","normalize","recReaddir","dir","dirCallback","fileCallback","endCallback","errorCallback","ignored","filterDir","currentDir","on","constructor","opts","Error","dot","glob","Array","isArray","hasIgnore","Boolean","length","doIgnore","root","resolve","fsEventsWatchStopper","watch","handleEvent","bind","_tracked","Set","add","emit","close","then","removeAllListeners","process","nextTick","isFileIncluded","relativePath","relative","lstat","error","stat","code","_emit","delete","type","file","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nfunction _events() {\n  const data = require('events');\n\n  _events = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction path() {\n  const data = _interopRequireWildcard(require('path'));\n\n  path = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _anymatch() {\n  const data = _interopRequireDefault(require('anymatch'));\n\n  _anymatch = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction fs() {\n  const data = _interopRequireWildcard(require('graceful-fs'));\n\n  fs = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _micromatch() {\n  const data = _interopRequireDefault(require('micromatch'));\n\n  _micromatch = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _walker() {\n  const data = _interopRequireDefault(require('walker'));\n\n  _walker = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {default: obj};\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== 'function') return null;\n  var cache = new WeakMap();\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || (typeof obj !== 'object' && typeof obj !== 'function')) {\n    return {default: obj};\n  }\n  var cache = _getRequireWildcardCache();\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor =\n    Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor\n        ? Object.getOwnPropertyDescriptor(obj, key)\n        : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj.default = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n// eslint-disable-next-line @typescript-eslint/prefer-ts-expect-error\n// @ts-ignore: this is for CI which runs linux and might not have this\nlet fsevents = null;\n\ntry {\n  fsevents = require('fsevents');\n} catch {\n  // Optional dependency, only supported on Darwin.\n}\n\nconst CHANGE_EVENT = 'change';\nconst DELETE_EVENT = 'delete';\nconst ADD_EVENT = 'add';\nconst ALL_EVENT = 'all';\n\n/**\n * Export `FSEventsWatcher` class.\n * Watches `dir`.\n */\nclass FSEventsWatcher extends _events().EventEmitter {\n  static isSupported() {\n    return fsevents !== null;\n  }\n\n  static normalizeProxy(callback) {\n    return (filepath, stats) => callback(path().normalize(filepath), stats);\n  }\n\n  static recReaddir(\n    dir,\n    dirCallback,\n    fileCallback,\n    endCallback,\n    errorCallback,\n    ignored\n  ) {\n    (0, _walker().default)(dir)\n      .filterDir(\n        currentDir => !ignored || !(0, _anymatch().default)(ignored, currentDir)\n      )\n      .on('dir', FSEventsWatcher.normalizeProxy(dirCallback))\n      .on('file', FSEventsWatcher.normalizeProxy(fileCallback))\n      .on('error', errorCallback)\n      .on('end', () => {\n        endCallback();\n      });\n  }\n\n  constructor(dir, opts) {\n    if (!fsevents) {\n      throw new Error(\n        '`fsevents` unavailable (this watcher can only be used on Darwin)'\n      );\n    }\n\n    super();\n\n    _defineProperty(this, 'root', void 0);\n\n    _defineProperty(this, 'ignored', void 0);\n\n    _defineProperty(this, 'glob', void 0);\n\n    _defineProperty(this, 'dot', void 0);\n\n    _defineProperty(this, 'hasIgnore', void 0);\n\n    _defineProperty(this, 'doIgnore', void 0);\n\n    _defineProperty(this, 'fsEventsWatchStopper', void 0);\n\n    _defineProperty(this, '_tracked', void 0);\n\n    this.dot = opts.dot || false;\n    this.ignored = opts.ignored;\n    this.glob = Array.isArray(opts.glob) ? opts.glob : [opts.glob];\n    this.hasIgnore =\n      Boolean(opts.ignored) && !(Array.isArray(opts) && opts.length > 0);\n    this.doIgnore = opts.ignored\n      ? (0, _anymatch().default)(opts.ignored)\n      : () => false;\n    this.root = path().resolve(dir);\n    this.fsEventsWatchStopper = fsevents.watch(\n      this.root,\n      this.handleEvent.bind(this)\n    );\n    this._tracked = new Set();\n    FSEventsWatcher.recReaddir(\n      this.root,\n      filepath => {\n        this._tracked.add(filepath);\n      },\n      filepath => {\n        this._tracked.add(filepath);\n      },\n      this.emit.bind(this, 'ready'),\n      this.emit.bind(this, 'error'),\n      this.ignored\n    );\n  }\n  /**\n   * End watching.\n   */\n\n  close(callback) {\n    this.fsEventsWatchStopper().then(() => {\n      this.removeAllListeners();\n\n      if (typeof callback === 'function') {\n        process.nextTick(callback.bind(null, null, true));\n      }\n    });\n  }\n\n  isFileIncluded(relativePath) {\n    if (this.doIgnore(relativePath)) {\n      return false;\n    }\n\n    return this.glob.length\n      ? (0, _micromatch().default)([relativePath], this.glob, {\n          dot: this.dot\n        }).length > 0\n      : this.dot ||\n          (0, _micromatch().default)([relativePath], '**/*').length > 0;\n  }\n\n  handleEvent(filepath) {\n    const relativePath = path().relative(this.root, filepath);\n\n    if (!this.isFileIncluded(relativePath)) {\n      return;\n    }\n\n    fs().lstat(filepath, (error, stat) => {\n      if (error && error.code !== 'ENOENT') {\n        this.emit('error', error);\n        return;\n      }\n\n      if (error) {\n        // Ignore files that aren't tracked and don't exist.\n        if (!this._tracked.has(filepath)) {\n          return;\n        }\n\n        this._emit(DELETE_EVENT, relativePath);\n\n        this._tracked.delete(filepath);\n\n        return;\n      }\n\n      if (this._tracked.has(filepath)) {\n        this._emit(CHANGE_EVENT, relativePath, stat);\n      } else {\n        this._tracked.add(filepath);\n\n        this._emit(ADD_EVENT, relativePath, stat);\n      }\n    });\n  }\n  /**\n   * Emit events.\n   */\n\n  _emit(type, file, stat) {\n    this.emit(type, file, this.root, stat);\n    this.emit(ALL_EVENT, type, file, this.root, stat);\n  }\n}\n\nmodule.exports = FSEventsWatcher;\n"]},"metadata":{},"sourceType":"script"}